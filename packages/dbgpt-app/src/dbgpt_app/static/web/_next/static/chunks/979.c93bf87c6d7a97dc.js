(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[979],{96991:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var o=t(87462),r=t(67294),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 144H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm0 400H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zM464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm0 400H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16z"}}]},name:"appstore",theme:"filled"},a=t(13401),i=r.forwardRef(function(e,n){return r.createElement(a.Z,(0,o.Z)({},e,{ref:n,icon:l}))})},36986:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var o=t(87462),r=t(67294),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-12-12-28.3-18.7-45.3-18.7H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 176h256v112H384V176zm128 554c-79.5 0-144-64.5-144-144s64.5-144 144-144 144 64.5 144 144-64.5 144-144 144zm0-224c-44.2 0-80 35.8-80 80s35.8 80 80 80 80-35.8 80-80-35.8-80-80-80z"}}]},name:"save",theme:"filled"},a=t(13401),i=r.forwardRef(function(e,n){return r.createElement(a.Z,(0,o.Z)({},e,{ref:n,icon:l}))})},49591:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var o=t(87462),r=t(67294),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h360c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H184V184h656v320c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V144c0-17.7-14.3-32-32-32zM653.3 599.4l52.2-52.2a8.01 8.01 0 00-4.7-13.6l-179.4-21c-5.1-.6-9.5 3.7-8.9 8.9l21 179.4c.8 6.6 8.9 9.4 13.6 4.7l52.4-52.4 256.2 256.2c3.1 3.1 8.2 3.1 11.3 0l42.4-42.4c3.1-3.1 3.1-8.2 0-11.3L653.3 599.4z"}}]},name:"select",theme:"outlined"},a=t(13401),i=r.forwardRef(function(e,n){return r.createElement(a.Z,(0,o.Z)({},e,{ref:n,icon:l}))})},88484:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var o=t(87462),r=t(67294),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},a=t(13401),i=r.forwardRef(function(e,n){return r.createElement(a.Z,(0,o.Z)({},e,{ref:n,icon:l}))})},47760:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return D}});var o=t(85893),r=t(62418),l=t(45360);t(96486);var a=t(87066);let i=a.default.create({baseURL:"http://localhost:5670"});i.defaults.timeout=1e4,i.interceptors.response.use(e=>e.data,e=>Promise.reject(e));let d={"content-type":"application/json","User-Id":(0,r.n5)()},u=(e,n)=>{if(n){let t=Object.keys(n).filter(e=>void 0!==n[e]&&""!==n[e]).map(e=>"".concat(e,"=").concat(n[e])).join("&");t&&(e+="?".concat(t))}return i.get("/api"+e,{headers:d}).then(e=>e).catch(e=>{l.ZP.error(e),Promise.reject(e)})},c=(e,n)=>i.post(e,n,{headers:d}).then(e=>e).catch(e=>{l.ZP.error(e),Promise.reject(e)});var s=t(16165),f=t(65654),g=t(25278),h=t(74309),v=t(83062),m=t(34041),k=t(20863),p=t(14726),x=t(39332),b=t(67294),y=t(13768),w=t(34625),j=t(74434),S=function(){return(0,o.jsx)("svg",{width:"1em",height:"1em",fill:"currentColor",viewBox:"0 0 1024 1024",version:"1.1",children:(0,o.jsx)("path",{d:"M161.05472 919.3472h701.9008a58.71616 58.71616 0 0 0 58.65472-58.65472V180.40832a58.71616 58.71616 0 0 0-58.65472-58.65472H161.09568a58.03008 58.03008 0 0 0-41.4208 17.08032A58.1632 58.1632 0 0 0 102.4 180.30592v680.38656a58.64448 58.64448 0 0 0 58.65472 58.65472z m385.15712-589.568V190.08512h306.95424v660.93056H546.21184V329.7792zM170.83392 190.08512h306.95424v660.93056H170.83392V190.08512z"})})},_=function(){return(0,o.jsx)("svg",{width:"1em",height:"1em",fill:"currentColor",viewBox:"0 0 1024 1024",version:"1.1",children:(0,o.jsx)("path",{d:"M171.85792 110.9504a58.65472 58.65472 0 0 0-58.65472 58.65472v701.9008a58.7264 58.7264 0 0 0 58.65472 58.65472h680.28416a58.7264 58.7264 0 0 0 58.65472-58.65472V169.64608a57.98912 57.98912 0 0 0-17.08032-41.41056 58.1632 58.1632 0 0 0-41.472-17.27488H171.85792z m670.60736 750.77632H181.53472V554.77248h660.93056v306.95424z m0-375.38816H181.53472V179.38432h660.93056v306.95424z"})})},Z=t(6171),N=t(18073),C=t(14313),q=t(36986),M=t(93967),H=t.n(M),z=t(91085);function V(){return(0,o.jsxs)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",children:[(0,o.jsx)("path",{d:"M512 64c-247.424 0-448 62.72-448 140.032v112c0 77.312 200.576 139.968 448 139.968s448-62.72 448-140.032v-112C960 126.72 759.424 64 512 64z m0 728c-247.424 0-448-62.72-448-140.032v168.064C64 897.28 264.576 960 512 960s448-62.72 448-140.032v-167.936c0 77.312-200.576 139.968-448 139.968z",fill:"#3699FF"}),(0,o.jsx)("path",{d:"M512 540.032c-247.424 0-448-62.72-448-140.032v168c0 77.312 200.576 140.032 448 140.032s448-62.72 448-140.032V400c0 77.312-200.576 140.032-448 140.032z",fill:"#3699FF",opacity:".32"})]})}function P(){return(0,o.jsx)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",children:(0,o.jsx)("path",{d:"M39.385 204.83h346.571L252.054 976.74l-23.63 39.383h259.929v-31.506L614.379 204.83H771.91S960.951 220.584 984.581 0.038H236.3S94.52-7.84 39.384 204.83",fill:"#1296db"})})}function B(){return(0,o.jsxs)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",children:[(0,o.jsx)("path",{d:"M149.2 99.7h726.6c27.7 0 50.1 22.4 50.1 50.1V336H99.1V149.8c0-27.6 22.4-50.1 50.1-50.1z",fill:"#1ECD93"}),(0,o.jsx)("path",{d:"M99.1 395h236.2v236.3H99.1zM99.1 690.3h236.2v236.2H149.2c-27.7 0-50.1-22.4-50.1-50.1V690.3zM394.4 395h236.2v236.3H394.4z",fill:"#1ECD93",fillOpacity:".5"}),(0,o.jsx)("path",{d:"M394.4 690.3h236.2v236.3H394.4z",fill:"#A1E6C9","data-spm-anchor-id":"a313x.search_index.0.i13.27343a81CqKUWU"}),(0,o.jsx)("path",{d:"M689.7 395h236.2v236.3H689.7z",fill:"#1ECD93",fillOpacity:".5"}),(0,o.jsx)("path",{d:"M689.7 690.3h236.2v186.1c0 27.7-22.4 50.1-50.1 50.1H689.7V690.3z",fill:"#A1E6C9","data-spm-anchor-id":"a313x.search_index.0.i17.27343a81CqKUWU"})]})}let{Search:E}=g.default;function L(e){let{layout:n="LR",editorValue:t,chartData:r,tableData:l,tables:a,handleChange:i}=e,d=(0,b.useMemo)(()=>r?(0,o.jsx)("div",{className:"flex-1 overflow-auto p-2",style:{flexShrink:0,overflow:"hidden"},children:(0,o.jsx)(y.ZP,{chartsData:[r]})}):null,[r]),{columns:u,dataSource:c}=(0,b.useMemo)(()=>{let{columns:e=[],values:n=[]}=null!=l?l:{},t=e.map(e=>({key:e,dataIndex:e,title:e})),o=n.map(n=>n.reduce((n,t,o)=>(n[e[o]]=t,n),{}));return{columns:t,dataSource:o}},[l]),s=(0,b.useMemo)(()=>{let e={},n=null==a?void 0:a.data,t=null==n?void 0:n.children;return null==t||t.forEach(n=>{e[n.title]=n.children.map(e=>({columnName:e.title,columnType:e.type}))}),{getTableList:async e=>e&&e!==(null==n?void 0:n.title)?[]:(null==t?void 0:t.map(e=>e.title))||[],getTableColumns:async n=>e[n]||[],getSchemaList:async()=>(null==n?void 0:n.title)?[null==n?void 0:n.title]:[]}},[a]);return(0,o.jsxs)("div",{className:H()("flex w-full flex-1 h-full gap-2 overflow-hidden",{"flex-col":"TB"===n,"flex-row":"LR"===n}),children:[(0,o.jsx)("div",{className:"flex-1 flex overflow-hidden rounded",children:(0,o.jsx)(j.Z,{value:(null==t?void 0:t.sql)||"",language:"mysql",onChange:i,thoughts:(null==t?void 0:t.thoughts)||"",session:s})}),(0,o.jsxs)("div",{className:"flex-1 h-full overflow-auto bg-white dark:bg-theme-dark-container rounded p-4",children:[(null==l?void 0:l.values.length)?(0,o.jsx)(h.Z,{bordered:!0,scroll:{x:"auto"},rowKey:u[0].key,columns:u,dataSource:c}):(0,o.jsx)("div",{className:"h-full flex justify-center items-center",children:(0,o.jsx)(z.Z,{})}),d]})]})}var D=function(){var e,n,t,r,l;let[a,i]=(0,b.useState)([]),[d,g]=(0,b.useState)(""),[h,y]=(0,b.useState)(),[j,M]=(0,b.useState)(!0),[z,D]=(0,b.useState)(),[T,U]=(0,b.useState)(),[O,R]=(0,b.useState)(),[A,F]=(0,b.useState)(),[I,G]=(0,b.useState)(),[W,$]=(0,b.useState)(!1),[K,Y]=(0,b.useState)("TB"),J=(0,x.useSearchParams)(),Q=null==J?void 0:J.get("id"),X=null==J?void 0:J.get("scene"),{data:ee}=(0,f.Z)(async()=>await u("/v1/editor/sql/rounds",{con_uid:Q}),{onSuccess:e=>{var n,t;let o=null==e?void 0:null===(n=e.data)||void 0===n?void 0:n[(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.length)-1];o&&y(null==o?void 0:o.round)}}),{run:en,loading:et}=(0,f.Z)(async()=>{var e,n;let t=null===(e=null==ee?void 0:null===(n=ee.data)||void 0===n?void 0:n.find(e=>e.round===h))||void 0===e?void 0:e.db_name;return await c("/api/v1/editor/sql/run",{db_name:t,sql:null==O?void 0:O.sql})},{manual:!0,onSuccess:e=>{var n,t;F({columns:null==e?void 0:null===(n=e.data)||void 0===n?void 0:n.colunms,values:null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.values})}}),{run:eo,loading:er}=(0,f.Z)(async()=>{var e,n;let t=null===(e=null==ee?void 0:null===(n=ee.data)||void 0===n?void 0:n.find(e=>e.round===h))||void 0===e?void 0:e.db_name,o={db_name:t,sql:null==O?void 0:O.sql};return"chat_dashboard"===X&&(o.chart_type=null==O?void 0:O.showcase),await c("/api/v1/editor/chart/run",o)},{manual:!0,ready:!!(null==O?void 0:O.sql),onSuccess:e=>{if(null==e?void 0:e.success){var n,t,o,r,l,a,i;F({columns:(null==e?void 0:null===(n=e.data)||void 0===n?void 0:null===(t=n.sql_data)||void 0===t?void 0:t.colunms)||[],values:(null==e?void 0:null===(o=e.data)||void 0===o?void 0:null===(r=o.sql_data)||void 0===r?void 0:r.values)||[]}),(null==e?void 0:null===(l=e.data)||void 0===l?void 0:l.chart_values)?D({type:null==e?void 0:null===(a=e.data)||void 0===a?void 0:a.chart_type,values:null==e?void 0:null===(i=e.data)||void 0===i?void 0:i.chart_values,title:null==O?void 0:O.title,description:null==O?void 0:O.thoughts}):D(void 0)}}}),{run:el,loading:ea}=(0,f.Z)(async()=>{var e,n,t,o,r;let l=null===(e=null==ee?void 0:null===(n=ee.data)||void 0===n?void 0:n.find(e=>e.round===h))||void 0===e?void 0:e.db_name;return await c("/api/v1/sql/editor/submit",{conv_uid:Q,db_name:l,conv_round:h,old_sql:null==T?void 0:T.sql,old_speak:null==T?void 0:T.thoughts,new_sql:null==O?void 0:O.sql,new_speak:(null===(t=null==O?void 0:null===(o=O.thoughts)||void 0===o?void 0:o.match(/^\n--(.*)\n\n$/))||void 0===t?void 0:null===(r=t[1])||void 0===r?void 0:r.trim())||(null==O?void 0:O.thoughts)})},{manual:!0,onSuccess:e=>{(null==e?void 0:e.success)&&en()}}),{run:ei,loading:ed}=(0,f.Z)(async()=>{var e,n,t,o,r,l;let a=null===(e=null==ee?void 0:null===(n=ee.data)||void 0===n?void 0:n.find(e=>e.round===h))||void 0===e?void 0:e.db_name;return await c("/api/v1/chart/editor/submit",{conv_uid:Q,chart_title:null==O?void 0:O.title,db_name:a,old_sql:null==T?void 0:null===(t=T[null!=I?I:0])||void 0===t?void 0:t.sql,new_chart_type:null==O?void 0:O.showcase,new_sql:null==O?void 0:O.sql,new_comment:(null===(o=null==O?void 0:null===(r=O.thoughts)||void 0===r?void 0:r.match(/^\n--(.*)\n\n$/))||void 0===o?void 0:null===(l=o[1])||void 0===l?void 0:l.trim())||(null==O?void 0:O.thoughts),gmt_create:new Date().getTime()})},{manual:!0,onSuccess:e=>{(null==e?void 0:e.success)&&eo()}}),{data:eu}=(0,f.Z)(async()=>{var e,n;let t=null===(e=null==ee?void 0:null===(n=ee.data)||void 0===n?void 0:n.find(e=>e.round===h))||void 0===e?void 0:e.db_name;return await u("/v1/editor/db/tables",{db_name:t,page_index:1,page_size:200})},{ready:!!(null===(e=null==ee?void 0:null===(n=ee.data)||void 0===n?void 0:n.find(e=>e.round===h))||void 0===e?void 0:e.db_name),refreshDeps:[null===(t=null==ee?void 0:null===(r=ee.data)||void 0===r?void 0:r.find(e=>e.round===h))||void 0===t?void 0:t.db_name]}),{run:ec}=(0,f.Z)(async e=>await u("/v1/editor/sql",{con_uid:Q,round:e}),{manual:!0,onSuccess:e=>{let n;try{if(Array.isArray(null==e?void 0:e.data))n=null==e?void 0:e.data,G(0);else if("string"==typeof(null==e?void 0:e.data)){let t=JSON.parse(null==e?void 0:e.data);n=t}else n=null==e?void 0:e.data}catch(e){console.log(e)}finally{U(n),Array.isArray(n)?R(null==n?void 0:n[Number(I||0)]):R(n)}}}),es=(0,b.useMemo)(()=>{let e=(n,t)=>n.map(n=>{let r=n.title,l=r.indexOf(d),a=r.substring(0,l),i=r.slice(l+d.length),u=e=>{switch(e){case"db":return(0,o.jsx)(V,{});case"table":return(0,o.jsx)(B,{});default:return(0,o.jsx)(P,{})}},c=l>-1?(0,o.jsx)(v.Z,{title:((null==n?void 0:n.comment)||(null==n?void 0:n.title))+((null==n?void 0:n.can_null)==="YES"?"(can null)":"(can't null)"),children:(0,o.jsxs)("div",{className:"flex items-center",children:[u(n.type),"\xa0\xa0\xa0",a,(0,o.jsx)("span",{className:"text-[#1677ff]",children:d}),i,"\xa0",(null==n?void 0:n.type)&&(0,o.jsx)("div",{className:"text-gray-400",children:null==n?void 0:n.type})]})}):(0,o.jsx)(v.Z,{title:((null==n?void 0:n.comment)||(null==n?void 0:n.title))+((null==n?void 0:n.can_null)==="YES"?"(can null)":"(can't null)"),children:(0,o.jsxs)("div",{className:"flex items-center",children:[u(n.type),"\xa0\xa0\xa0",r,"\xa0",(null==n?void 0:n.type)&&(0,o.jsx)("div",{className:"text-gray-400",children:null==n?void 0:n.type})]})});if(n.children){let o=t?String(t)+"_"+n.key:n.key;return{title:r,showTitle:c,key:o,children:e(n.children,o)}}return{title:r,showTitle:c,key:n.key}});return(null==eu?void 0:eu.data)?(i([null==eu?void 0:eu.data.key]),e([null==eu?void 0:eu.data])):[]},[d,eu]),ef=(0,b.useMemo)(()=>{let e=[],n=(t,o)=>{if(t&&!((null==t?void 0:t.length)<=0))for(let r=0;r<t.length;r++){let l=t[r],{key:a,title:i}=l;e.push({key:a,title:i,parentKey:o}),l.children&&n(l.children,a)}};return es&&n(es),e},[es]),eg=(e,n)=>{let t;for(let o=0;o<n.length;o++){let r=n[o];r.children&&(r.children.some(n=>n.key===e)?t=r.key:eg(e,r.children)&&(t=eg(e,r.children)))}return t};function eh(e){let n;if(!e)return{sql:"",thoughts:""};let t=e&&e.match(/(--.*)?\n?([\s\S]*)/),o="";return t&&t.length>=3&&(o=t[1],n=t[2]),{sql:n,thoughts:o}}return(0,b.useEffect)(()=>{h&&ec(h)},[ec,h]),(0,b.useEffect)(()=>{T&&"chat_dashboard"===X&&I&&eo()},[I,X,T,eo]),(0,b.useEffect)(()=>{T&&"chat_dashboard"!==X&&en()},[X,T,en]),(0,o.jsxs)("div",{className:"flex flex-col w-full h-full overflow-hidden",children:[(0,o.jsx)(w.Z,{}),(0,o.jsxs)("div",{className:"relative flex flex-1 p-4 pt-0 overflow-hidden",children:[(0,o.jsxs)("div",{className:"relative flex overflow-hidden mr-4",children:[(0,o.jsx)("div",{className:H()("h-full relative transition-[width] overflow-hidden",{"w-0":W,"w-64":!W}),children:(0,o.jsxs)("div",{className:"relative w-64 h-full overflow-hidden flex flex-col rounded bg-white dark:bg-theme-dark-container p-4",children:[(0,o.jsx)(m.default,{size:"middle",className:"w-full mb-2",value:h,options:null==ee?void 0:null===(l=ee.data)||void 0===l?void 0:l.map(e=>({label:e.round_name,value:e.round})),onChange:e=>{y(e)}}),(0,o.jsx)(E,{className:"mb-2",placeholder:"Search",onChange:e=>{let{value:n}=e.target;if(null==eu?void 0:eu.data){if(n){let e=ef.map(e=>e.title.indexOf(n)>-1?eg(e.key,es):null).filter((e,n,t)=>e&&t.indexOf(e)===n);i(e)}else i([]);g(n),M(!0)}}}),es&&es.length>0&&(0,o.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,o.jsx)(k.Z,{onExpand:e=>{i(e),M(!1)},expandedKeys:a,autoExpandParent:j,treeData:es,fieldNames:{title:"showTitle"}})})]})}),(0,o.jsx)("div",{className:"absolute right-0 top-0 translate-x-full h-full flex items-center justify-center opacity-0 hover:opacity-100 group-hover/side:opacity-100 transition-opacity",children:(0,o.jsx)("div",{className:"bg-white w-4 h-10 flex items-center justify-center dark:bg-theme-dark-container rounded-tr rounded-br z-10 text-xs cursor-pointer shadow-[4px_0_10px_rgba(0,0,0,0.06)] text-opacity-80",onClick:()=>{$(!W)},children:W?(0,o.jsx)(N.Z,{}):(0,o.jsx)(Z.Z,{})})})]}),(0,o.jsxs)("div",{className:"flex flex-col flex-1 max-w-full overflow-hidden",children:[(0,o.jsxs)("div",{className:"mb-2 bg-white dark:bg-theme-dark-container p-2 flex justify-between items-center",children:[(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)(p.ZP,{className:"text-xs rounded-none",size:"small",type:"primary",icon:(0,o.jsx)(C.Z,{}),loading:et||er,onClick:async()=>{"chat_dashboard"===X?eo():en()},children:"Run"}),(0,o.jsx)(p.ZP,{className:"text-xs rounded-none",type:"primary",size:"small",loading:ea||ed,icon:(0,o.jsx)(q.Z,{}),onClick:async()=>{"chat_dashboard"===X?await ei():await el()},children:"Save"})]}),(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)(s.Z,{className:H()("flex items-center justify-center w-6 h-6 text-lg rounded",{"bg-theme-primary bg-opacity-10":"TB"===K}),component:_,onClick:()=>{Y("TB")}}),(0,o.jsx)(s.Z,{className:H()("flex items-center justify-center w-6 h-6 text-lg rounded",{"bg-theme-primary bg-opacity-10":"LR"===K}),component:S,onClick:()=>{Y("LR")}})]})]}),Array.isArray(T)?(0,o.jsxs)("div",{className:"flex flex-col h-full overflow-hidden",children:[(0,o.jsx)("div",{className:"w-full whitespace-nowrap overflow-x-auto bg-white dark:bg-theme-dark-container mb-2 text-[0px]",children:T.map((e,n)=>(0,o.jsx)(v.Z,{className:"inline-block",title:e.title,children:(0,o.jsx)("div",{className:H()("max-w-[240px] px-3 h-10 text-ellipsis overflow-hidden whitespace-nowrap text-sm leading-10 cursor-pointer font-semibold hover:text-theme-primary transition-colors mr-2 last-of-type:mr-0",{"border-b-2 border-solid border-theme-primary text-theme-primary":I===n}),onClick:()=>{G(n),R(null==T?void 0:T[n])},children:e.title})},e.title))}),(0,o.jsx)("div",{className:"flex flex-1 overflow-hidden",children:T.map((e,n)=>(0,o.jsx)("div",{className:H()("w-full overflow-hidden",{hidden:n!==I,"block flex-1":n===I}),children:(0,o.jsx)(L,{layout:K,editorValue:e,handleChange:e=>{let{sql:n,thoughts:t}=eh(e);R(e=>Object.assign({},e,{sql:n,thoughts:t}))},tableData:A,chartData:z})},e.title))})]}):(0,o.jsx)(L,{layout:K,editorValue:T,handleChange:e=>{let{sql:n,thoughts:t}=eh(e);R(e=>Object.assign({},e,{sql:n,thoughts:t}))},tableData:A,chartData:void 0,tables:eu})]})]})]})}},34625:function(e,n,t){"use strict";t.d(n,{Z:function(){return H}});var o=t(85893),r=t(41468),l=t(81799),a=t(82353),i=t(16165),d=t(96991),u=t(78045),c=t(67294);function s(){let{isContract:e,setIsContract:n,scene:t}=(0,c.useContext)(r.p),l=t&&["chat_with_db_execute","chat_dashboard"].includes(t);return l?(0,o.jsxs)(u.ZP.Group,{value:e,defaultValue:!0,buttonStyle:"solid",onChange:()=>{n(!e)},children:[(0,o.jsxs)(u.ZP.Button,{value:!1,children:[(0,o.jsx)(i.Z,{component:a.ig,className:"mr-1"}),"Preview"]}),(0,o.jsxs)(u.ZP.Button,{value:!0,children:[(0,o.jsx)(d.Z,{className:"mr-1"}),"Editor"]})]}):null}t(23293);var f=t(76212),g=t(65654),h=t(34041),v=t(67421),m=function(){let{t:e}=(0,v.$G)(),{agent:n,setAgent:t}=(0,c.useContext)(r.p),{data:l=[]}=(0,g.Z)(async()=>{let[,e]=await (0,f.Vx)((0,f.H4)());return null!=e?e:[]});return(0,o.jsx)(h.default,{className:"w-60",value:n,placeholder:e("Select_Plugins"),options:l.map(e=>({label:e.app_name,value:e.app_code})),allowClear:!0,onChange:e=>{null==t||t(e)}})},k=t(29158),p=t(95378),x=t(49591),b=t(88484),y=t(45360),w=t(83062),j=t(23799),S=t(14726),_=function(e){var n;let{convUid:t,chatMode:l,onComplete:a,...i}=e,[d,u]=(0,c.useState)(!1),[s,g]=y.ZP.useMessage(),[h,v]=(0,c.useState)([]),[m,_]=(0,c.useState)(),{model:Z}=(0,c.useContext)(r.p),{temperatureValue:N,maxNewTokensValue:C}=(0,c.useContext)(p.ChatContentContext),q=async e=>{var n;if(!e){y.ZP.error("Please select the *.(csv|xlsx|xls) file");return}if(!/\.(csv|xlsx|xls)$/.test(null!==(n=e.file.name)&&void 0!==n?n:"")){y.ZP.error("File type must be csv, xlsx or xls");return}v([e.file])},M=async()=>{u(!0);try{let e=new FormData;e.append("doc_file",h[0]),s.open({content:"Uploading ".concat(h[0].name),type:"loading",duration:0});let[n]=await (0,f.Vx)((0,f.qn)({convUid:t,chatMode:l,data:e,model:Z,temperatureValue:N,maxNewTokensValue:C,config:{timeout:36e5,onUploadProgress:e=>{let n=Math.ceil(e.loaded/(e.total||0)*100);_(n)}}}));if(n)return;y.ZP.success("success"),null==a||a()}catch(e){y.ZP.error((null==e?void 0:e.message)||"Upload Error")}finally{u(!1),s.destroy()}};return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"flex items-start gap-2",children:[g,(0,o.jsx)(w.Z,{placement:"bottom",title:"File cannot be changed after upload",children:(0,o.jsx)(j.default,{disabled:d,className:"mr-1",beforeUpload:()=>!1,fileList:h,name:"file",accept:".csv,.xlsx,.xls",multiple:!1,onChange:q,showUploadList:{showDownloadIcon:!1,showPreviewIcon:!1,showRemoveIcon:!1},itemRender:()=>(0,o.jsx)(o.Fragment,{}),...i,children:(0,o.jsx)(S.ZP,{className:"flex justify-center items-center",type:"primary",disabled:d,icon:(0,o.jsx)(x.Z,{}),children:"Select File"})})}),(0,o.jsx)(S.ZP,{type:"primary",loading:d,className:"flex justify-center items-center",disabled:!h.length,icon:(0,o.jsx)(b.Z,{}),onClick:M,children:d?100===m?"Analysis":"Uploading":"Upload"}),!!h.length&&(0,o.jsxs)("div",{className:"mt-2 text-gray-500 text-sm flex items-center",onClick:()=>v([]),children:[(0,o.jsx)(k.Z,{className:"mr-2"}),(0,o.jsx)("span",{children:null===(n=h[0])||void 0===n?void 0:n.name})]})]})})},Z=function(e){let{onComplete:n}=e,{currentDialogue:t,scene:l,chatId:a}=(0,c.useContext)(r.p);return"chat_excel"!==l?null:(0,o.jsx)("div",{className:"max-w-md h-full relative",children:t?(0,o.jsxs)("div",{className:"flex h-8 overflow-hidden rounded",children:[(0,o.jsx)("div",{className:"flex items-center justify-center px-2 bg-gray-600 text-lg",children:(0,o.jsx)(k.Z,{className:"text-white"})}),(0,o.jsx)("div",{className:"flex items-center justify-center px-3 bg-gray-100 text-xs rounded-tr rounded-br dark:text-gray-800 truncate",children:t.select_param})]}):(0,o.jsx)(_,{convUid:a,chatMode:l,onComplete:n})})},N=t(23430),C=t(62418),q=t(2093),M=function(){let{scene:e,dbParam:n,setDbParam:t}=(0,c.useContext)(r.p),[l,a]=(0,c.useState)([]);(0,q.Z)(async()=>{let[,n]=await (0,f.Vx)((0,f.vD)(e));a(null!=n?n:[])},[e]);let i=(0,c.useMemo)(()=>{var e;return null===(e=l.map)||void 0===e?void 0:e.call(l,e=>({name:e.param,...C.S$[e.type]}))},[l]);return((0,c.useEffect)(()=>{(null==i?void 0:i.length)&&!n&&t(i[0].name)},[i,t,n]),null==i?void 0:i.length)?(0,o.jsx)(h.default,{value:n,className:"w-36",onChange:e=>{t(e)},children:i.map(e=>(0,o.jsxs)(h.default.Option,{children:[(0,o.jsx)(N.Z,{width:24,height:24,src:e.icon,label:e.label,className:"w-[1.5em] h-[1.5em] mr-1 inline-block mt-[-4px]"}),e.name]},e.name))}):null},H=function(e){let{refreshHistory:n,modelChange:t}=e,{scene:a,refreshDialogList:i}=(0,c.useContext)(r.p);return(0,o.jsxs)("div",{className:"w-full py-2 px-4 md:px-4 flex flex-wrap items-center justify-center gap-1 md:gap-4",children:[(0,o.jsx)(l.Z,{onChange:t}),(0,o.jsx)(M,{}),"chat_excel"===a&&(0,o.jsx)(Z,{onComplete:()=>{null==i||i(),null==n||n()}}),"chat_agent"===a&&(0,o.jsx)(m,{}),(0,o.jsx)(s,{})]})}},81799:function(e,n,t){"use strict";t.d(n,{A:function(){return f}});var o=t(85893),r=t(41468),l=t(19284),a=t(34041),i=t(25675),d=t.n(i),u=t(67294),c=t(67421);let s="/models/huggingface.svg";function f(e,n){var t,r;let{width:a,height:i}=n||{};return e?(0,o.jsx)(d(),{className:"rounded-full border border-gray-200 object-contain bg-white inline-block",width:a||24,height:i||24,src:(null===(t=l.Hf[e])||void 0===t?void 0:t.icon)||s,alt:"llm"},(null===(r=l.Hf[e])||void 0===r?void 0:r.icon)||s):null}n.Z=function(e){let{onChange:n}=e,{t}=(0,c.$G)(),{modelList:i,model:d}=(0,u.useContext)(r.p);return!i||i.length<=0?null:(0,o.jsx)(a.default,{value:d,placeholder:t("choose_model"),className:"w-52",onChange:e=>{null==n||n(e)},children:i.map(e=>{var n;return(0,o.jsx)(a.default.Option,{children:(0,o.jsxs)("div",{className:"flex items-center",children:[f(e),(0,o.jsx)("span",{className:"ml-2",children:(null===(n=l.Hf[e])||void 0===n?void 0:n.label)||e})]})},e)})})}},74434:function(e,n,t){"use strict";let o;t.d(n,{Z:function(){return h}});var r=t(85893),l=t(41468),a=t(62418),i=t(63764),d=t(3930),u=t(93967),c=t.n(u),s=t(72339),f=t(67294);async function g(){window.obMonaco={getWorkerUrl:e=>{switch(e){case"mysql":return location.origin+"/_next/static/ob-workers/mysql.js";case"obmysql":return location.origin+"/_next/static/ob-workers/obmysql.js";case"oboracle":return location.origin+"/_next/static/ob-workers/oracle.js"}return""}};let e=await t.e(2057).then(t.bind(t,12057)),n=e.default;return o||(o=new n).setup(["mysql"]),o}function h(e){let{className:n,value:t,language:o="mysql",onChange:u,thoughts:s,session:h}=e,v=(0,f.useMemo)(()=>"mysql"!==o?t:s&&s.length>0?(0,a._m)("-- ".concat(s," \n").concat(t)):(0,a._m)(t),[t,s]),m=(0,d.Z)(h),k=(0,f.useContext)(l.p);async function p(e){var n,t;let o=await g();o.setModelOptions((null===(n=e.getModel())||void 0===n?void 0:n.id)||"",function(e,n){let{_modelId:t,delimiter:o}=e;return{delimiter:o,async getTableList(e){var t;return(null==n?void 0:null===(t=n())||void 0===t?void 0:t.getTableList(e))||[]},async getTableColumns(e,t){var o;return(null==n?void 0:null===(o=n())||void 0===o?void 0:o.getTableColumns(e))||[]},async getSchemaList(){var e;return(null==n?void 0:null===(e=n())||void 0===e?void 0:e.getSchemaList())||[]}}}({modelId:(null===(t=e.getModel())||void 0===t?void 0:t.id)||"",delimiter:";"},()=>m.current||null))}return(0,r.jsx)(i.ZP,{className:c()(n),onMount:p,value:v,defaultLanguage:o,onChange:u,theme:(null==k?void 0:k.mode)!=="dark"?"github":"githubDark",options:{minimap:{enabled:!1},wordWrap:"on"}})}i._m.config({monaco:s}),s.editor.defineTheme("github",{base:"vs",inherit:!0,rules:[{background:"ffffff",token:""},{foreground:"6a737d",token:"comment"},{foreground:"6a737d",token:"punctuation.definition.comment"},{foreground:"6a737d",token:"string.comment"},{foreground:"005cc5",token:"constant"},{foreground:"005cc5",token:"entity.name.constant"},{foreground:"005cc5",token:"variable.other.constant"},{foreground:"005cc5",token:"variable.language"},{foreground:"6f42c1",token:"entity"},{foreground:"6f42c1",token:"entity.name"},{foreground:"24292e",token:"variable.parameter.function"},{foreground:"22863a",token:"entity.name.tag"},{foreground:"d73a49",token:"keyword"},{foreground:"d73a49",token:"storage"},{foreground:"d73a49",token:"storage.type"},{foreground:"24292e",token:"storage.modifier.package"},{foreground:"24292e",token:"storage.modifier.import"},{foreground:"24292e",token:"storage.type.java"},{foreground:"032f62",token:"string"},{foreground:"032f62",token:"punctuation.definition.string"},{foreground:"032f62",token:"string punctuation.section.embedded source"},{foreground:"005cc5",token:"support"},{foreground:"005cc5",token:"meta.property-name"},{foreground:"e36209",token:"variable"},{foreground:"24292e",token:"variable.other"},{foreground:"b31d28",fontStyle:"bold italic underline",token:"invalid.broken"},{foreground:"b31d28",fontStyle:"bold italic underline",token:"invalid.deprecated"},{foreground:"fafbfc",background:"b31d28",fontStyle:"italic underline",token:"invalid.illegal"},{foreground:"fafbfc",background:"d73a49",fontStyle:"italic underline",token:"carriage-return"},{foreground:"b31d28",fontStyle:"bold italic underline",token:"invalid.unimplemented"},{foreground:"b31d28",token:"message.error"},{foreground:"24292e",token:"string source"},{foreground:"005cc5",token:"string variable"},{foreground:"032f62",token:"source.regexp"},{foreground:"032f62",token:"string.regexp"},{foreground:"032f62",token:"string.regexp.character-class"},{foreground:"032f62",token:"string.regexp constant.character.escape"},{foreground:"032f62",token:"string.regexp source.ruby.embedded"},{foreground:"032f62",token:"string.regexp string.regexp.arbitrary-repitition"},{foreground:"22863a",fontStyle:"bold",token:"string.regexp constant.character.escape"},{foreground:"005cc5",token:"support.constant"},{foreground:"005cc5",token:"support.variable"},{foreground:"005cc5",token:"meta.module-reference"},{foreground:"735c0f",token:"markup.list"},{foreground:"005cc5",fontStyle:"bold",token:"markup.heading"},{foreground:"005cc5",fontStyle:"bold",token:"markup.heading entity.name"},{foreground:"22863a",token:"markup.quote"},{foreground:"24292e",fontStyle:"italic",token:"markup.italic"},{foreground:"24292e",fontStyle:"bold",token:"markup.bold"},{foreground:"005cc5",token:"markup.raw"},{foreground:"b31d28",background:"ffeef0",token:"markup.deleted"},{foreground:"b31d28",background:"ffeef0",token:"meta.diff.header.from-file"},{foreground:"b31d28",background:"ffeef0",token:"punctuation.definition.deleted"},{foreground:"22863a",background:"f0fff4",token:"markup.inserted"},{foreground:"22863a",background:"f0fff4",token:"meta.diff.header.to-file"},{foreground:"22863a",background:"f0fff4",token:"punctuation.definition.inserted"},{foreground:"e36209",background:"ffebda",token:"markup.changed"},{foreground:"e36209",background:"ffebda",token:"punctuation.definition.changed"},{foreground:"f6f8fa",background:"005cc5",token:"markup.ignored"},{foreground:"f6f8fa",background:"005cc5",token:"markup.untracked"},{foreground:"6f42c1",fontStyle:"bold",token:"meta.diff.range"},{foreground:"005cc5",token:"meta.diff.header"},{foreground:"005cc5",fontStyle:"bold",token:"meta.separator"},{foreground:"005cc5",token:"meta.output"},{foreground:"586069",token:"brackethighlighter.tag"},{foreground:"586069",token:"brackethighlighter.curly"},{foreground:"586069",token:"brackethighlighter.round"},{foreground:"586069",token:"brackethighlighter.square"},{foreground:"586069",token:"brackethighlighter.angle"},{foreground:"586069",token:"brackethighlighter.quote"},{foreground:"b31d28",token:"brackethighlighter.unmatched"},{foreground:"b31d28",token:"sublimelinter.mark.error"},{foreground:"e36209",token:"sublimelinter.mark.warning"},{foreground:"959da5",token:"sublimelinter.gutter-mark"},{foreground:"032f62",fontStyle:"underline",token:"constant.other.reference.link"},{foreground:"032f62",fontStyle:"underline",token:"string.other.link"}],colors:{"editor.foreground":"#24292e","editor.background":"#ffffff","editor.selectionBackground":"#c8c8fa","editor.inactiveSelectionBackground":"#fafbfc","editor.lineHighlightBackground":"#fafbfc","editorCursor.foreground":"#24292e","editorWhitespace.foreground":"#959da5","editorIndentGuide.background":"#959da5","editorIndentGuide.activeBackground":"#24292e","editor.selectionHighlightBorder":"#fafbfc"}}),s.editor.defineTheme("githubDark",{base:"vs-dark",inherit:!0,rules:[{background:"24292e",token:""},{foreground:"959da5",token:"comment"},{foreground:"959da5",token:"punctuation.definition.comment"},{foreground:"959da5",token:"string.comment"},{foreground:"c8e1ff",token:"constant"},{foreground:"c8e1ff",token:"entity.name.constant"},{foreground:"c8e1ff",token:"variable.other.constant"},{foreground:"c8e1ff",token:"variable.language"},{foreground:"b392f0",token:"entity"},{foreground:"b392f0",token:"entity.name"},{foreground:"f6f8fa",token:"variable.parameter.function"},{foreground:"7bcc72",token:"entity.name.tag"},{foreground:"ea4a5a",token:"keyword"},{foreground:"ea4a5a",token:"storage"},{foreground:"ea4a5a",token:"storage.type"},{foreground:"f6f8fa",token:"storage.modifier.package"},{foreground:"f6f8fa",token:"storage.modifier.import"},{foreground:"f6f8fa",token:"storage.type.java"},{foreground:"79b8ff",token:"string"},{foreground:"79b8ff",token:"punctuation.definition.string"},{foreground:"79b8ff",token:"string punctuation.section.embedded source"},{foreground:"c8e1ff",token:"support"},{foreground:"c8e1ff",token:"meta.property-name"},{foreground:"fb8532",token:"variable"},{foreground:"f6f8fa",token:"variable.other"},{foreground:"d73a49",fontStyle:"bold italic underline",token:"invalid.broken"},{foreground:"d73a49",fontStyle:"bold italic underline",token:"invalid.deprecated"},{foreground:"fafbfc",background:"d73a49",fontStyle:"italic underline",token:"invalid.illegal"},{foreground:"fafbfc",background:"d73a49",fontStyle:"italic underline",token:"carriage-return"},{foreground:"d73a49",fontStyle:"bold italic underline",token:"invalid.unimplemented"},{foreground:"d73a49",token:"message.error"},{foreground:"f6f8fa",token:"string source"},{foreground:"c8e1ff",token:"string variable"},{foreground:"79b8ff",token:"source.regexp"},{foreground:"79b8ff",token:"string.regexp"},{foreground:"79b8ff",token:"string.regexp.character-class"},{foreground:"79b8ff",token:"string.regexp constant.character.escape"},{foreground:"79b8ff",token:"string.regexp source.ruby.embedded"},{foreground:"79b8ff",token:"string.regexp string.regexp.arbitrary-repitition"},{foreground:"7bcc72",fontStyle:"bold",token:"string.regexp constant.character.escape"},{foreground:"c8e1ff",token:"support.constant"},{foreground:"c8e1ff",token:"support.variable"},{foreground:"c8e1ff",token:"meta.module-reference"},{foreground:"fb8532",token:"markup.list"},{foreground:"0366d6",fontStyle:"bold",token:"markup.heading"},{foreground:"0366d6",fontStyle:"bold",token:"markup.heading entity.name"},{foreground:"c8e1ff",token:"markup.quote"},{foreground:"f6f8fa",fontStyle:"italic",token:"markup.italic"},{foreground:"f6f8fa",fontStyle:"bold",token:"markup.bold"},{foreground:"c8e1ff",token:"markup.raw"},{foreground:"b31d28",background:"ffeef0",token:"markup.deleted"},{foreground:"b31d28",background:"ffeef0",token:"meta.diff.header.from-file"},{foreground:"b31d28",background:"ffeef0",token:"punctuation.definition.deleted"},{foreground:"176f2c",background:"f0fff4",token:"markup.inserted"},{foreground:"176f2c",background:"f0fff4",token:"meta.diff.header.to-file"},{foreground:"176f2c",background:"f0fff4",token:"punctuation.definition.inserted"},{foreground:"b08800",background:"fffdef",token:"markup.changed"},{foreground:"b08800",background:"fffdef",token:"punctuation.definition.changed"},{foreground:"2f363d",background:"959da5",token:"markup.ignored"},{foreground:"2f363d",background:"959da5",token:"markup.untracked"},{foreground:"b392f0",fontStyle:"bold",token:"meta.diff.range"},{foreground:"c8e1ff",token:"meta.diff.header"},{foreground:"0366d6",fontStyle:"bold",token:"meta.separator"},{foreground:"0366d6",token:"meta.output"},{foreground:"ffeef0",token:"brackethighlighter.tag"},{foreground:"ffeef0",token:"brackethighlighter.curly"},{foreground:"ffeef0",token:"brackethighlighter.round"},{foreground:"ffeef0",token:"brackethighlighter.square"},{foreground:"ffeef0",token:"brackethighlighter.angle"},{foreground:"ffeef0",token:"brackethighlighter.quote"},{foreground:"d73a49",token:"brackethighlighter.unmatched"},{foreground:"d73a49",token:"sublimelinter.mark.error"},{foreground:"fb8532",token:"sublimelinter.mark.warning"},{foreground:"6a737d",token:"sublimelinter.gutter-mark"},{foreground:"79b8ff",fontStyle:"underline",token:"constant.other.reference.link"},{foreground:"79b8ff",fontStyle:"underline",token:"string.other.link"}],colors:{"editor.foreground":"#f6f8fa","editor.background":"#24292e","editor.selectionBackground":"#4c2889","editor.inactiveSelectionBackground":"#444d56","editor.lineHighlightBackground":"#444d56","editorCursor.foreground":"#ffffff","editorWhitespace.foreground":"#6a737d","editorIndentGuide.background":"#6a737d","editorIndentGuide.activeBackground":"#f6f8fa","editor.selectionHighlightBorder":"#444d56"}})},91085:function(e,n,t){"use strict";var o=t(85893),r=t(32983),l=t(14726),a=t(93967),i=t.n(a),d=t(67421);n.Z=function(e){let{className:n,error:t,description:a,refresh:u}=e,{t:c}=(0,d.$G)();return(0,o.jsx)(r.Z,{image:"/empty.png",imageStyle:{width:320,height:196,margin:"0 auto",maxWidth:"100%",maxHeight:"100%"},className:i()("flex items-center justify-center flex-col h-full w-full",n),description:t?(0,o.jsx)(l.ZP,{type:"primary",onClick:u,children:c("try_again")}):null!=a?a:c("no_data")})}},23293:function(){},36459:function(e,n,t){"use strict";function o(e){if(null==e)throw TypeError("Cannot destructure "+e)}t.d(n,{Z:function(){return o}})}}]);